local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

local function formatNumber(num)
    if num == 0 then
        return "0"
    end
    local suffixes = {"", "K", "M", "B", "T", "Qa", "Qi"}
    local i = 1
    while num >= 1000 and i < #suffixes do
        num = num / 1000
        i = i + 1
    end
    if math.floor(num) == num then
        return string.format("%d%s", num, suffixes[i])
    else
        return string.format("%.2f%s", num, suffixes[i]):gsub("%.00", "")
    end
end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "LeaderboardGui"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

local FloatingButton = Instance.new("TextButton")
FloatingButton.Size = UDim2.new(0, 200, 0, 50)
FloatingButton.Position = UDim2.new(0.05, 0, 0.2, 0)
FloatingButton.BackgroundColor3 = Color3.fromRGB(61, 10, 161)
FloatingButton.TextColor3 = Color3.new(1,1,1)
FloatingButton.Font = Enum.Font.SourceSansBold
FloatingButton.TextSize = 18
FloatingButton.Text = "Sad v1.0.0.2 | See Stats"
FloatingButton.Parent = ScreenGui
FloatingButton.Active = true
FloatingButton.Draggable = true

local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 700, 0, 400)
Frame.Position = UDim2.new(0.5, -350, 0.1, 0)
Frame.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
Frame.BorderSizePixel = 0
Frame.Active = true
Frame.Draggable = true
Frame.Parent = ScreenGui
Frame.Visible = false

local Header = Instance.new("Frame")
Header.Size = UDim2.new(1, 0, 0, 40)
Header.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
Header.BorderSizePixel = 0
Header.Parent = Frame

local TitleLabel = Instance.new("TextLabel")
TitleLabel.Size = UDim2.new(0, 200, 1, 0)
TitleLabel.Position = UDim2.new(0, 10, 0, 0)
TitleLabel.Font = Enum.Font.SourceSansBold
TitleLabel.TextSize = 20
TitleLabel.TextColor3 = Color3.new(1,1,1)
TitleLabel.BackgroundTransparency = 1
TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
TitleLabel.Text = ""
TitleLabel.Visible = false
TitleLabel.Parent = Header

local columnWidths = {0.25, 0.2, 0.2, 0.15, 0.2}
local headers = {"Player", "Strength", "Durability", "Kills", "Damage"}
local headerLabels = {}

for i, text in ipairs(headers) do
    local lbl = Instance.new("TextLabel")
    lbl.Size = UDim2.new(columnWidths[i], 0, 1, 0)
    lbl.Position = UDim2.new((i == 1 and 0) or (columnWidths[1] + (i > 2 and columnWidths[2] or 0) + (i > 3 and columnWidths[3] or 0) + (i > 4 and columnWidths[4] or 0)), 0, 0, 0)
    lbl.Text = text
    lbl.Font = Enum.Font.SourceSansBold
    lbl.TextSize = 20
    lbl.TextColor3 = Color3.new(1,1,1)
    lbl.BackgroundTransparency = 1
    lbl.TextXAlignment = Enum.TextXAlignment.Center
    lbl.Parent = Header
    table.insert(headerLabels, lbl)
end

local MinimizeButton = Instance.new("TextButton")
MinimizeButton.Size = UDim2.new(0, 30, 1, 0)
MinimizeButton.Position = UDim2.new(1, -35, 0, 0)
MinimizeButton.Text = "-"
MinimizeButton.Font = Enum.Font.SourceSansBold
MinimizeButton.TextSize = 20
MinimizeButton.TextColor3 = Color3.new(1,1,1)
MinimizeButton.BackgroundTransparency = 1
MinimizeButton.Parent = Header

local minimized = false

local PlayerListFrame = Instance.new("ScrollingFrame")
PlayerListFrame.Size = UDim2.new(1, -10, 1, -50)
PlayerListFrame.Position = UDim2.new(0, 5, 0, 45)
PlayerListFrame.CanvasSize = UDim2.new(0,0,0,0)
PlayerListFrame.ScrollBarThickness = 6
PlayerListFrame.BackgroundTransparency = 1
PlayerListFrame.Parent = Frame

MinimizeButton.MouseButton1Click:Connect(function()
    minimized = not minimized
    if minimized then
        MinimizeButton.Text = "+"
        Frame.Size = UDim2.new(0, 700, 0, 40)
        PlayerListFrame.Visible = false
        TitleLabel.Visible = true
        TitleLabel.Text = "Sad v1.0.0.2 | See Stats"
        for _, lbl in ipairs(headerLabels) do
            lbl.Visible = false
        end
    else
        MinimizeButton.Text = "-"
        Frame.Size = UDim2.new(0, 700, 0, 400)
        PlayerListFrame.Visible = true
        TitleLabel.Visible = false
        for _, lbl in ipairs(headerLabels) do
            lbl.Visible = true
        end
    end
end)

FloatingButton.MouseButton1Click:Connect(function()
    Frame.Visible = not Frame.Visible
end)

local function createPlayerRow(player, index)
    local row = Instance.new("Frame")
    row.Size = UDim2.new(1, 0, 0, 35)
    row.Position = UDim2.new(0,0,0,(index-1)*35)
    row.BackgroundColor3 = (index % 2 == 0) and Color3.fromRGB(35, 35, 50) or Color3.fromRGB(25, 25, 40)
    row.BorderSizePixel = 0
    row.Parent = PlayerListFrame

    local labels = {}

    for i = 1, #headers do
        local lbl = Instance.new("TextLabel")
        lbl.Size = UDim2.new(columnWidths[i], 0, 1, 0)
        lbl.Position = UDim2.new((i == 1 and 0) or (columnWidths[1] + (i > 2 and columnWidths[2] or 0) + (i > 3 and columnWidths[3] or 0) + (i > 4 and columnWidths[4] or 0)), 0, 0, 0)
        lbl.Font = Enum.Font.SourceSansBold
        lbl.TextSize = 18
        lbl.TextColor3 = Color3.new(1,1,1)
        lbl.BackgroundTransparency = 1
        lbl.TextXAlignment = (i == 1) and Enum.TextXAlignment.Left or Enum.TextXAlignment.Center
        lbl.Parent = row
        labels[i] = lbl
    end

    RunService.Heartbeat:Connect(function()
        if not player.Parent then return end
        local stats = player:FindFirstChild("leaderstats")
        local Strength, Durability, Kills, Damage = 0,0,0,0

        if stats then
            Strength = stats:FindFirstChild("Strength") and stats.Strength.Value or 0
            Kills = stats:FindFirstChild("Kills") and stats.Kills.Value or 0
        end

        Durability = player:FindFirstChild("Durability") and player.Durability.Value or 0
        Damage = player:FindFirstChild("Damage") and player.Damage.Value or 0

        local values = {
            player.Name,
            formatNumber(Strength),
            formatNumber(Durability),
            formatNumber(Kills),
            formatNumber(Damage)
        }

        for i, val in ipairs(values) do
            labels[i].Text = val
        end
    end)
end

local function updateLeaderboard()
    for _, child in pairs(PlayerListFrame:GetChildren()) do
        if child:IsA("Frame") then
            child:Destroy()
        end
    end

    local players = Players:GetPlayers()
    for i, player in ipairs(players) do
        createPlayerRow(player, i)
    end

    PlayerListFrame.CanvasSize = UDim2.new(0, 0, 0, #players * 35)
end

Players.PlayerAdded:Connect(updateLeaderboard)
Players.PlayerRemoving:Connect(updateLeaderboard)
updateLeaderboard()
