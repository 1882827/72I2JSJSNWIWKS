local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

local function formatNumber(num)
    local suffixes = {"", "K", "M", "B", "T", "Qa", "Qi"}
    local i = 1
    while num >= 1000 and i < #suffixes do
        num = num / 1000
        i = i + 1
    end
    return string.format("%.2f%s", num, suffixes[i])
end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "LeaderboardGui"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 700, 0, 380)
Frame.Position = UDim2.new(0.5, -350, 0.1, 0)
Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
Frame.BorderSizePixel = 0
Frame.Parent = ScreenGui

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 40)
Title.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
Title.BorderSizePixel = 0
Title.Text = "Player                  Strength                  Durability                  Kills                  Damage"
Title.TextColor3 = Color3.new(1,1,1)
Title.Font = Enum.Font.SourceSansBold
Title.TextSize = 20
Title.Parent = Frame

local PlayerListFrame = Instance.new("ScrollingFrame")
PlayerListFrame.Size = UDim2.new(1, -10, 1, -50)
PlayerListFrame.Position = UDim2.new(0, 5, 0, 45)
PlayerListFrame.CanvasSize = UDim2.new(0,0,0,0)
PlayerListFrame.ScrollBarThickness = 6
PlayerListFrame.BackgroundTransparency = 1
PlayerListFrame.Parent = Frame

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Parent = PlayerListFrame

local function createPlayerRow(player)
    local row = Instance.new("TextLabel")
    row.Size = UDim2.new(1, -10, 0, 30)
    row.BackgroundTransparency = 1
    row.TextColor3 = Color3.new(1,1,1)
    row.Font = Enum.Font.SourceSans
    row.TextSize = 18
    row.TextXAlignment = Enum.TextXAlignment.Left
    row.Text = ""
    row.Name = player.Name
    row.Parent = PlayerListFrame
    return row
end

local function updateLeaderboard()
    for _, row in pairs(PlayerListFrame:GetChildren()) do
        if row:IsA("TextLabel") then
            row:Destroy()
        end
    end
    
    for _, player in pairs(Players:GetPlayers()) do
        local stats = player:FindFirstChild("leaderstats")
        if stats then
            local Strength = stats:FindFirstChild("Strength") and stats.Strength.Value or 0
            local Durability = stats:FindFirstChild("Durability") and stats.Durability.Value or 0
            local Kills = stats:FindFirstChild("Kills") and stats.Kills.Value or 0
            local Damage = stats:FindFirstChild("Damage") and stats.Damage.Value or 0

            local row = createPlayerRow(player)
            row.Text = string.format(
                "%-20s   %-20s   %-20s   %-20s   %-20s",
                player.DisplayName,
                formatNumber(Strength),
                formatNumber(Durability),
                formatNumber(Kills),
                formatNumber(Damage)
            )
        end
    end
    
    PlayerListFrame.CanvasSize = UDim2.new(0,0,0,#Players:GetPlayers() * 32)
end

RunService.Heartbeat:Connect(updateLeaderboard)
Players.PlayerAdded:Connect(updateLeaderboard)
Players.PlayerRemoving:Connect(updateLeaderboard)
